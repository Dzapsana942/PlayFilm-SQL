## ğŸ“Œ 1. Struktura bazy danych

Baza **PlayFilm** zawiera nastÄ™pujÄ…ce tabele:

- **Users** â€“ informacje o uÅ¼ytkownikach
- **Plans** â€“ plany subskrypcji
- **UserPlans** â€“ historia planÃ³w uÅ¼ytkownikÃ³w
- **Movies** â€“ katalog filmÃ³w
- **WatchHistory** â€“ historia oglÄ…dania
- **Ratings** â€“ oceny filmÃ³w (1 ocena uÅ¼ytkownika na film â€“ constraint UNIQUE)

Projekt odzwierciedla realnÄ… logikÄ™ dziaÅ‚ania platform streamingowych.

---

## ğŸ“Œ 2. PrzykÅ‚adowe dane

Plik `02_insert_sample_data.sql` zawiera dane umoÅ¼liwiajÄ…ce realistyczne raportowanie:

- uÅ¼ytkownicy z kilku krajÃ³w,
- filmy rÃ³Å¼nych gatunkÃ³w i z rÃ³Å¼nych lat,
- wielokrotne sesje oglÄ…dania,
- oceny filmÃ³w,
- historia zmian planÃ³w subskrypcji.

Dane zostaÅ‚y zaprojektowane tak, aby rÃ³Å¼ne zapytania analityczne dawaÅ‚y sensowne wyniki.

---

## ğŸ“Œ 3. Widoki analityczne

### âœ” `vw_UserSummary`
Podsumowanie aktywnoÅ›ci uÅ¼ytkownikÃ³w (liczba filmÃ³w, sesji oglÄ…dania, minuty, Å›rednia ocen).

### âœ” `vw_MovieStats`
Statystyki oglÄ…dalnoÅ›ci i ocen filmÃ³w (minuty, liczba odsÅ‚on, liczba ocen, Å›rednia ocena).

### âœ” `vw_MovieRankingByMinutes`
Ranking filmÃ³w wg Å‚Ä…cznego czasu oglÄ…dania (funkcja okna `RANK()`).

### âœ” `vw_CountryStats`
Zbiorcze statystyki aktywnoÅ›ci uÅ¼ytkownikÃ³w z podziaÅ‚em na kraje.

SzczegÃ³Å‚y: `03_views.sql`

---

## ğŸ“Œ 4. PrzykÅ‚ady raportÃ³w

Wszystkie zapytania analityczne znajdujÄ… siÄ™ w osobnym pliku:

ğŸ‘‰ **`03.2_reports_examples.sql`**

Znajdziesz tam m.in.:

- ranking filmÃ³w,
- najaktywniejszych uÅ¼ytkownikÃ³w,
- porÃ³wnania krajÃ³w,
- statystyki miesiÄ™czne,
- przykÅ‚ady uÅ¼ycia funkcji okna.

---

## ğŸ“Œ 5. BezpieczeÅ„stwo i role

Plik `04_security_and_roles.sql` implementuje:

- login `playfilm_reader`,
- user w bazie,
- rolÄ™ raportowÄ… `report_reader`,
- GRANT SELECT tylko na widoki,
- DENY na wszystkie tabele,
- test uprawnieÅ„ poprzez `EXECUTE AS USER`.

Taki model bezpieczeÅ„stwa odwzorowuje realne Å›rodowisko raportowe.

---

## ğŸ§° Technologie

- Microsoft SQL Server (2019+)
- T-SQL (DDL, DML, CTE, funkcje okna, role, uprawnienia)
- SQL Server Management Studio (SSMS)

---

## ğŸ¯ Cel projektu

Celem projektu jest nauka zaawansowanego SQL oraz stworzenie profesjonalnego przykÅ‚adu do portfolio GitHub:

- logiczny model danych,
- raporty,
- widoki analityczne,
- zarzÄ…dzanie uprawnieniami,
- przykÅ‚ad rzeczywistego projektu BI/SQL.

---

# ğŸŒ English Version

## ğŸ“Œ 1. Database Structure

The **PlayFilm** database includes the following tables:

- **Users** â€“ user information  
- **Plans** â€“ subscription plans  
- **UserPlans** â€“ subscription history per user  
- **Movies** â€“ movie catalog  
- **WatchHistory** â€“ watch sessions with timestamps and minutes watched  
- **Ratings** â€“ movie ratings (each user can rate a movie only once)

This structure reflects the logic of real streaming platforms.

---

## ğŸ“Œ 2. Sample Data

File: `02_insert_sample_data.sql`

Includes realistic datasets for analytics:

- users from multiple countries  
- movies of various genres and years  
- multiple watch sessions per user  
- movie ratings from different users  
- subscription plan history

The sample data is designed to produce meaningful analytical results.

---

## ğŸ“Œ 3. Analytical Views

### âœ” `vw_UserSummary`
Aggregated user activity (movies watched, number of sessions, total minutes, average rating).

### âœ” `vw_MovieStats`
Aggregated movie performance (total watch time, number of views, ratings count, average rating).

### âœ” `vw_MovieRankingByMinutes`
Ranking of movies using a window function:

```sql
RANK() OVER (ORDER BY MinutesWatched DESC)
âœ” vw_CountryStats
Country-level aggregated analytics based on user activity.

All view definitions: 03_views.sql

ğŸ“Œ 4. Reporting Examples
All analytical query examples are stored in:

ğŸ‘‰ 03.2_reports_examples.sql

This file contains queries such as:

movie rankings

top active users

country comparisons

monthly activity

window function examples

ğŸ“Œ 5. Security & Roles
File: 04_security_and_roles.sql

Implements:

login playfilm_reader

database user

reporting role report_reader

GRANT SELECT only on views

DENY all operations on base tables

security testing using EXECUTE AS USER

This represents a realistic BI/reporting security model in SQL Server.

ğŸ§° Technologies
Microsoft SQL Server

T-SQL (DDL, DML, CTE, window functions, database roles)

SQL Server Management Studio (SSMS)

ğŸ¯ Project Objective
Showcase SQL skills through a complete analytical project:

relational data model

reporting views

CTE and window functions

security model

example analytical queries

This project serves as a portfolio example for data analytics and SQL engineering roles.
